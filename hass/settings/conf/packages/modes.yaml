---
automation:
  - alias: "Activate Blackout when we're in bed"
    id: "activate_blackout_when_we_re_in_bed"
    trigger:
      - platform: state
        entity_id: binary_sensor.in_bed
        to: "on"
    action:
      service: input_boolean.turn_on
      data:
        entity_id: input_boolean.blackout_mode

  - alias: "Adjust automations in Blackout Mode"
    id: "adjust_automations_in_blackout_mode"
    trigger:
      - platform: state
        entity_id: input_boolean.blackout_mode
        to: "on"
    action:
      scene: scene.blackout_mode

  - alias: "Adjust automations in Guest Mode"
    id: "adjust_automations_in_guest_mode"
    trigger:
      platform: state
      entity_id: input_boolean.guest_mode
      to: "on"
    action:
      scene: scene.guest_mode

  - alias: "Adjust automations in Vacation Mode"
    id: "adjust_automations_in_vacation_mode"
    trigger:
      platform: state
      entity_id: input_boolean.vacation_mode
      to: "on"
    action:
      scene: scene.vacation_mode

  - alias: "Reset automations when no mode is active"
    id: "reset_automations_when_no_mode_is_active"
    trigger:
      - platform: event
        event_type: call_service
        event_data:
          domain: scene
          service: turn_on
          service_data:
            entity_id: scene.drive_home
      - platform: event
        event_type: call_service
        event_data:
          domain: scene
          service: turn_on
          service_data:
            entity_id: scene.walk_home
      - platform: state
        entity_id: input_boolean.blackout_mode
        to: "off"
      - platform: state
        entity_id: input_boolean.guest_mode
        to: "off"
      - platform: state
        entity_id: input_boolean.vacation_mode
        to: "off"
      - platform: state
        entity_id: sensor.proximity_zone
        to: Home
    action:
      scene: scene.base

input_boolean:
  blackout_mode:
    icon: mdi:weather-night
    name: Blackout Mode
  guest_mode:
    icon: mdi:hotel
    name: Guest Mode
  vacation_mode:
    icon: mdi:beach
    name: Vacation Mode
