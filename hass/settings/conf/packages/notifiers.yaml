---
notify:
  - platform: group
    name: aaron
    services:
      - service: mobile_app_aarons_iphone
      - service: mobile_app_aaron_s_personal_macbook_pro

  - platform: group
    name: britt
    services:
      - service: mobile_app_britts_iphone

  - platform: group
    name: everyone
    services:
      - service: mobile_app_aarons_iphone
      - service: mobile_app_aaron_s_personal_macbook_pro
      - service: mobile_app_britts_iphone

script:
  notify_everyone_critical:
    fields:
      message:
        description: The message to send
        example: Your hair is on fire!
      title:
        description: The optional title to include
        example: Heads Up
    sequence:
      - service: notify.everyone
        data:
          message: "{{ message }}"
          title: "{{ title }}"
          data:
            push:
              interruption-level: critical
              sound:
                name: "default"
                critical: 1
                volume: 0.5
            tag: "{{ message }}"

  notify_everyone_at_home:
    fields:
      message:
        description: The message to send
        example: Your hair is on fire!
      title:
        description: The optional title to include
        example: Heads Up
    sequence:
      - choose:
          conditions:
            condition: state
            entity_id: person.aaron
            state: home
          sequence:
            service: notify.aaron
            data:
              message: "{{ message }}"
              title: "{{ title }}"
              data:
                tag: "{{ message }}"

      - choose:
          conditions:
            condition: state
            entity_id: person.britt
            state: home
          sequence:
            service: notify.britt
            data:
              message: "{{ message }}"
              title: "{{ title }}"
              data:
                tag: "{{ message }}"
