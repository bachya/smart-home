---
camera:
  - platform: mjpeg
    name: OctoPrint
    still_image_url: http://octopi.phil.iot/webcam/?action=snapshot
    mjpeg_url: http://octopi.phil.iot/webcam/?action=stream

octoprint:
  host: octopi.phil.iot
  api_key: !secret octoprint_api_key
  name: Ender 3
  bed: true
  number_of_tools: 1

sensor:
  - platform: command_line
    name: OctoPi CPU Temperature
    command: >
      ssh -i /config/id_ed25519 -o StrictHostKeyChecking=no
      bachya@octopi.phil.iot
      cat /sys/class/thermal/thermal_zone*/temp 2>/dev/null |
      awk \'{ sum += $1; n++ } END { if (n > 0) print (sum / n) / 1000; }\'
    unit_of_measurement: "Â°C"

  - platform: command_line
    name: OctoPi Uptime
    command: >
      ssh -i /config/id_ed25519 -o StrictHostKeyChecking=no
      bachya@octopi.phil.iot
      cat /proc/uptime | awk \'{ print $1 / 86400 }\' | cut -f1 -d"."
    unit_of_measurement: "days"
