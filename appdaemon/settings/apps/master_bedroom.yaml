---
master_bedroom_lights_sleep_timer_automation:
  module: switches
  class: SleepTimer
  dependencies:
    - presence_manager
  entity_ids:
    switch: switch.master_bedroom_salt_lamp
    timer_slider: input_number.master_bedroom_salt_lamp_timer

master_bedroom_lights_on_at_sunset_automation:
  module: services
  class: ServiceOnState
  service: "switch/turn_on"
  service_data:
    entity_id: switch.master_bedroom_salt_lamp
  entity_ids:
    target_entity_id: sun.sun
  properties:
    target_state: below_horizon
  state_changes:
    - disable:
        event: MODE_CHANGE
        event_data:
          name: guest_mode
          state: "on"
      enable:
        event: MODE_CHANGE
        event_data:
          name: guest_mode
          state: "off"
    - disable:
        event: MODE_CHANGE
        event_data:
          name: vacation_mode
          state: "on"
      enable:
        event: MODE_CHANGE
        event_data:
          name: vacation_mode
          state: "off"

master_bathroom_fan_double_tap_timer_automation:
  module: switches
  class: DoubleTapTimerSwitch
  dependencies:
    - presence_manager
  entity_ids:
    timer_slider: input_number.master_bathroom_fan_timer
    zwave_device: zwave.master_bathroom_fan
  properties:
    duration: 3600

master_bathroom_fan_sleep_timer_automation:
  module: switches
  class: SleepTimer
  dependencies:
    - presence_manager
  entity_ids:
    switch: switch.master_bathroom_fan
    timer_slider: input_number.master_bathroom_fan_timer

master_toilet_fan_double_tap_timer_automation:
  module: switches
  class: DoubleTapTimerSwitch
  dependencies:
    - presence_manager
  entity_ids:
    timer_slider: input_number.master_bathroom_toilet_fan_timer
    zwave_device: zwave.master_toilet_fan
  properties:
    duration: 600

master_toilet_fan_toggle_automation:
  module: switches
  class: ToggleOnInterval
  dependencies:
    - guest_mode
    - vacation_mode
  entity_ids:
    switch: switch.master_toilet_fan
  properties:
    end_time: "17:00:00"
    duration: 900
    state: "on"
    start_time: "10:00:00"
    window: 3600
  state_changes:
    - disable:
        event: MODE_CHANGE
        event_data:
          name: vacation_mode
          state: "on"
      enable:
        event: MODE_CHANGE
        event_data:
          name: vacation_mode
          state: "off"
    - disable:
        event: MODE_CHANGE
        event_data:
          name: blackout_mode
          state: "on"
      enable:
        event: MODE_CHANGE
        event_data:
          name: blackout_mode
          state: "off"
    - disable:
        event: MODE_CHANGE
        event_data:
          name: guest_mode
          state: "on"
      enable:
        event: MODE_CHANGE
        event_data:
          name: guest_mode
          state: "off"
    - disable:
        event: PROXIMITY_CHANGE
        event_data:
          old: home
      enable:
        event: PROXIMITY_CHANGE
        event_data:
          new: home

master_toilet_fan_sleep_timer_automation:
  module: switches
  class: SleepTimer
  dependencies:
    - presence_manager
  entity_ids:
    switch: switch.master_toilet_fan
    timer_slider: input_number.master_bathroom_toilet_fan_timer
