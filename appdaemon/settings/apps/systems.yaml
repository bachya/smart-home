---
aaron_accountability_automation:
  module: systems
  class: AaronAccountability
  dependencies:
    - aaron
    - presence_manager
    - blackout_mode
  entity_ids:
    aaron_router_tracker: device_tracker.aarons_iphone

notify_of_low_batteries_automation:
  module: systems
  class: LowBatteries
  dependencies:
    - presence_manager
  entity_ids:
    batteries_to_monitor:
      - binary_sensor.guest_bedroom_sensor_low_battery
      - binary_sensor.kitchen_sensor_low_battery
      - binary_sensor.upstairs_hallway_sensor_low_battery
      - sensor.aeotec_nanomote_quad_aaron_bedside_battery
      - sensor.fiddle_leaf_fig_battery
      - sensor.front_door_lock_battery
      - sensor.garage_fire_door_lock_battery
      - sensor.kitchen_sink_sensor_battery
  properties:
    battery_level_threshold: 20
    notification_interval: 900
  state_changes:
    - disable:
        event: MODE_CHANGE
        event_data:
          name: vacation_mode
          state: "on"
      enable:
        event: MODE_CHANGE
        event_data:
          name: vacation_mode
          state: "off"
    - disable:
        event: MODE_CHANGE
        event_data:
          name: blackout_mode
          state: "on"
      enable:
        event: MODE_CHANGE
        event_data:
          name: blackout_mode
          state: "off"
    - disable:
        event: PROXIMITY_CHANGE
        event_data:
          old: home
      enable:
        event: PROXIMITY_CHANGE
        event_data:
          new: home

notify_media_center_left_on_automation:
  module: systems
  class: LeftInState
  dependencies:
    - presence_manager
  entity_ids:
    entity_id: switch.media_center
  properties:
    duration: 43200
    notification_target:
      - "person:Aaron"
      - "person:Britt"
    state: "on"
  state_changes:
    - disable:
        event: MODE_CHANGE
        event_data:
          name: vacation_mode
          state: "on"
      enable:
        event: MODE_CHANGE
        event_data:
          name: vacation_mode
          state: "off"
    - disable:
        event: MODE_CHANGE
        event_data:
          name: blackout_mode
          state: "on"
      enable:
        event: MODE_CHANGE
        event_data:
          name: blackout_mode
          state: "off"

notify_ps4_left_on_automation:
  module: systems
  class: LeftInState
  dependencies:
    - presence_manager
  entity_ids:
    entity_id: media_player.playstation_4
  properties:
    duration: 43200
    notification_target:
      - "person:Aaron"
      - "person:Britt"
    state: "idle"
  state_changes:
    - disable:
        event: MODE_CHANGE
        event_data:
          name: vacation_mode
          state: "on"
      enable:
        event: MODE_CHANGE
        event_data:
          name: vacation_mode
          state: "off"
    - disable:
        event: MODE_CHANGE
        event_data:
          name: blackout_mode
          state: "on"
      enable:
        event: MODE_CHANGE
        event_data:
          name: blackout_mode
          state: "off"

notify_of_dead_zwave_devices_automation:
  module: systems
  class: NotifyOfDeadZwaveDevices
  dependencies:
    - presence_manager

start_homekit_on_zwave_ready_automation:
  module: systems
  class: StartHomeKitOnZwaveReady
  entity_ids:
    to_exclude:
      - zwave.aeotec_nanomote_quad_aaron_bedside
